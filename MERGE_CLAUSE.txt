
-- MERGE 
--------------
/*SQL, the MERGE statement is used to perform an "upsert" operation, which is a combination of an INSERT and an UPDATE operation. 
It allows you to conditionally insert or update data into a target table based on whether the matching 
rows exist in the source table or not. The MERGE statement is often used to synchronize data between two tables.

SYNTAX:
-------
MERGE INTO target_table USING source_table
ON (condition_to_match_rows)
WHEN MATCHED THEN
    UPDATE SET column1 = value1, column2 = value2, ...
WHEN NOT MATCHED THEN
    INSERT (column1, column2, ...)
    VALUES (value1, value2, ...);
*/

DROP TABLE EMPLOYEEID;

CREATE TABLE EMPLOYEEID(
    ID INT,
    FIRST_NAME VARCHAR2(50),
    LAST_NAME VARCHAR2(50),
	DEPT VARCHAR2(50),
    SAL NUMBER(5,2)
);


INSERT INTO EMPLOYEEID (ID,FIRST_NAME,LAST_NAME,DEPT,SAL) VALUES (11,'DILIPKUMAR','PITCHAIMUTHU','IT',800);
INSERT INTO EMPLOYEEID (ID,FIRST_NAME,LAST_NAME,DEPT,SAL) VALUES (12,'SEENIVASAN','SELVAMANI','MSW',700);
INSERT INTO EMPLOYEEID (ID,FIRST_NAME,LAST_NAME,DEPT,SAL) VALUES (13,'HARIKRISHNAN','HARIDASS','COMMERCE',600);
INSERT INTO EMPLOYEEID (ID,FIRST_NAME,LAST_NAME,DEPT,SAL) VALUES (14,'KESAV','VENUGOPAL','SOCIAL DEVELOPMENT',800);

DROP TABLE EMPLOYEEID_S;

CREATE TABLE EMPLOYEEID_S AS SELECT * FROM EMPLOYEEID;


INSERT INTO EMPLOYEEID_S (ID,FIRST_NAME,LAST_NAME,DEPT,SAL) VALUES (14,'KESAVAN','VENUGOPALAN','SOCIAL DEVELOPMENT',850);

INSERT INTO EMPLOYEEID_S (ID,FIRST_NAME,LAST_NAME,DEPT,SAL) VALUES (13,'HARIKRISHNA','HARIDASS KERALA','SOCIAL WORKER',750);

INSERT INTO EMPLOYEEID_S (ID,FIRST_NAME,LAST_NAME,DEPT,SAL) VALUES (18,'AMUTHA','KRISHNASAMY','AGRICULTURE AND FERTILIZER',750);


SELECT * FROM EMPLOYEEID;

SELECT * FROM EMPLOYEEID_S;

DELETE FROM EMPLOYEEID_S; -- IT IS FOR DELETING ALL RECORDS IN  A TABLE

MERGE INTO EMPLOYEEID E
USING   EMPLOYEEID_S E1
ON (E.ID = E1.ID)
WHEN MATCHED THEN
UPDATE SET 
    	E.FIRST_NAME=E1.FIRST_NAME,
    	E.LAST_NAME = E1.LAST_NAME,
    	E.DEPT = E1.DEPT,
    	E.SAL = E1.SAL    
WHEN NOT MATCHED THEN 
		INSERT (ID,FIRST_NAME,LAST_NAME,DEPT,SAL) VALUES (E1.ID,E1.FIRST_NAME,E1.LAST_NAME,E1.DEPT,E1.SAL)

SELECT * FROM EMPLOYEEID;